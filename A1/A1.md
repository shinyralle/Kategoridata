A1
================
Magnus Brogie, Rahul Duggal
12 November 2018

# Assignment 1

## 1\. Hur många percent av män respektive kvinnor är för och emot laglig abort?

``` r
library(tidyverse)
```

    ## -- Attaching packages ---------------------------------- tidyverse 1.2.1 --

    ## v ggplot2 3.1.0     v purrr   0.2.5
    ## v tibble  1.4.2     v dplyr   0.7.7
    ## v tidyr   0.8.2     v stringr 1.3.1
    ## v readr   1.1.1     v forcats 0.3.0

    ## -- Conflicts ------------------------------------- tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
# install.packages("kableExtra")
cont_table = matrix(
  c(309, 191, 319, 281), # the data elements 
  nrow=2,              # number of rows 
  ncol=2,              # number of columns 
  byrow = TRUE)  # fill matrix by rows 
cont_table
```

    ##      [,1] [,2]
    ## [1,]  309  191
    ## [2,]  319  281

``` r
women_men = rowSums(cont_table)
favor_against = colSums(cont_table)
total = sum(cont_table)

# Calculates percentages by matrix multiplication
(percentages_matrix <- diag(1 / women_men) %*% cont_table) * 100
```

    ##          [,1]     [,2]
    ## [1,] 61.80000 38.20000
    ## [2,] 53.16667 46.83333

``` r
colnames(percentages_matrix) <- c("In Favor", "Against")
rownames(percentages_matrix) <- c("Women", "Men")
percentages_matrix #  %>% knitr::kable()
```

    ##        In Favor   Against
    ## Women 0.6180000 0.3820000
    ## Men   0.5316667 0.4683333

``` r
expected_matrix <- total * (diag(1 / women_men)  %*% cont_table) * (cont_table %*% diag(1 / favor_against))
expected_matrix
```

    ##          [,1]     [,2]
    ## [1,] 334.4876 170.0386
    ## [2,] 297.0730 306.6988

``` r
cont_table
```

    ##      [,1] [,2]
    ## [1,]  309  191
    ## [2,]  319  281

``` r
cont_minus_expected <- cont_table - expected_matrix
cont_minus_expected_squared  <- cont_minus_expected * cont_minus_expected
test_matrix <- cont_minus_expected_squared / expected_matrix
chi_two_statistic <- sum(test_matrix)
chi_two_statistic 
```

    ## [1] 8.297921

Procent anger antal hundradelar och noteras med %. Vi kan beräkna hur
många procent \(kn\) är av \(m\) genom att ställa upp
\(100 \times n/m\). Detta fungerar eftersom vår siffersystem är
decimalt. Således blir andelen kvinnor som är för laglig abort i procent
\[100 \times \frac{\text{antal kvinnor för laglig abort}}{\text{totalt antal kvinnor}}\]
och andelen kvinnor som är emot laglig abort i procent
\[100 \times \frac{\text{antal kvinnor mot laglig abort}}{\text{totalt antal kvinnor}}\],
och motsvarande för män. Dessa beräknar ger oss följande tabell med
procent: \`

``` r
(100 * percentages_matrix) %>% knitr::kable()
```

|       | In Favor |  Against |
| ----- | -------: | -------: |
| Women | 61.80000 | 38.20000 |
| Men   | 53.16667 | 46.83333 |

\[
\begin{aligned} 
G^{2} &= 2 \sum_{i} \sum_{j} \text{ observed } \times \ln \left( \frac{\text{observed}}{\text{expected}} \right)\\
&=2n \sum_{i} \sum_{j}  \widehat{p}_{ij} \ln \left( \frac{\widehat{p}_{ij}}{p_{ij}} \right)
\end{aligned}
\]

``` r
cont_table = matrix(
  c(309, 191, 319, 281), # the data elements 
  nrow=2,              # number of rows 
  ncol=2,              # number of columns 
  byrow = TRUE)  # fill matrix by rows 
cont_table
```

    ##      [,1] [,2]
    ## [1,]  309  191
    ## [2,]  319  281

``` r
women_men = rowSums(cont_table)
women_men
```

    ## [1] 500 600

``` r
diag(1 / women_men)
```

    ##       [,1]        [,2]
    ## [1,] 0.002 0.000000000
    ## [2,] 0.000 0.001666667

``` r
favor_against = colSums(cont_table)
favor_against
```

    ## [1] 628 472

``` r
total = sum(cont_table)

(percentages_matrix <- diag(1 / women_men) %*% cont_table) * 100
```

    ##          [,1]     [,2]
    ## [1,] 61.80000 38.20000
    ## [2,] 53.16667 46.83333

``` r
colnames(percentages_matrix) <- c("In Favor", "Against")
rownames(percentages_matrix) <- c("Women", "Men")
percentages_matrix #  %>% knitr::kable()
```

    ##        In Favor   Against
    ## Women 0.6180000 0.3820000
    ## Men   0.5316667 0.4683333

``` r
expected_matrix <- total *  ((women_men / total)) %*%  t((favor_against / total))

# shift.column(diag((favor_against / total)))

(diag(1 / women_men)  %*% cont_table) 
```

    ##           [,1]      [,2]
    ## [1,] 0.6180000 0.3820000
    ## [2,] 0.5316667 0.4683333

``` r
(cont_table %*% diag(1 / favor_against))
```

    ##           [,1]     [,2]
    ## [1,] 0.4920382 0.404661
    ## [2,] 0.5079618 0.595339

``` r
total * (cont_table %*% diag(1 / favor_against)) * (diag(1 / women_men)  %*% cont_table)
```

    ##          [,1]     [,2]
    ## [1,] 334.4876 170.0386
    ## [2,] 297.0730 306.6988

``` r
expected_matrix
```

    ##          [,1]     [,2]
    ## [1,] 285.4545 214.5455
    ## [2,] 342.5455 257.4545

``` r
cont_table
```

    ##      [,1] [,2]
    ## [1,]  309  191
    ## [2,]  319  281

``` r
sum(expected_matrix)
```

    ## [1] 1100

``` r
obs_divided_by_expected <- cont_table / expected_matrix
obs_divided_by_expected
```

    ##           [,1]      [,2]
    ## [1,] 1.0824841 0.8902542
    ## [2,] 0.9312633 1.0914548

``` r
sapply(obs_divided_by_expected, log)
```

    ## [1]  0.07925847 -0.07121326 -0.11624820  0.08751149

``` r
 matrix(sapply(obs_divided_by_expected, log), nrow = 2)
```

    ##             [,1]        [,2]
    ## [1,]  0.07925847 -0.11624820
    ## [2,] -0.07121326  0.08751149

``` r
log_obs_divided_by_expected <-  matrix(sapply(obs_divided_by_expected, log), nrow = 2)
log_obs_divided_by_expected 
```

    ##             [,1]        [,2]
    ## [1,]  0.07925847 -0.11624820
    ## [2,] -0.07121326  0.08751149

``` r
obs_mult_by_log_obs_divided_by_expected <- cont_table * log_obs_divided_by_expected
obs_mult_by_log_obs_divided_by_expected
```

    ##           [,1]      [,2]
    ## [1,]  24.49087 -22.20341
    ## [2,] -22.71703  24.59073

``` r
gee_two <- 2 * sum(obs_mult_by_log_obs_divided_by_expected)
gee_two
```

    ## [1] 8.32232

``` r
309*log(309/((628/1100)*(500/1100)*1100)) +
191*log(191/((472/1100)*(500/1100)*1100)) +
319*log(319/((628/1100)*(600/1100)*1100)) +
281*log(281/((472/1100)*(600/1100)*1100)) 
```

    ## [1] 4.16116

``` r
(309/628)*(309/500)*1100
```

    ## [1] 334.4876

``` r
# f(x) <- function()
```

## 2\.

Skiljer värdena i tabellen sig signifikant från de som skulle förväntas
ifall att kön och att vara för eller emot laglig abort vore oberoende?
Vi vill testa \[
\begin{aligned}
H_{0}: & \text{ den förklaranden variabeln är oberoende av responsvariablen } \Leftrightarrow \\
       &\pi_{ij} = \pi_{i\circ}\pi_{\circ j} \text{ för alla $i$ och $j$}
\end{aligned}
\]

Persons \(X^{2}\) statiska kan användas för att testa en hypotetisk
fördelning i en kontingenstabell. Den är \(\chi^{2}(f!!)\) FIXA\!
fördelad och beräknas enligt följande

\[
\begin{aligned}
\chi^{2} &= \sum_{i} \sum_{j}  \frac{(\text{observed} - \text{expected})^{2}}{\text{expected}}\\
         &= \sum_{i} \sum_{j}  \frac{(x_{ij} - e_{ij})^{2}}{e_{ij}}
\end{aligned}
\]

där “expected”, “\(e_{ij}\)”, är de förväntade värdena i
kontingenstabellen på rad \(i\) och kolumn \(j\) under hypotesen och
“observed”, “\(x_{ij}\)”, är motsvarande observerade värde i
kontingenstabellen.

Under antagandet att antal som är för respektive emot laglig abort är
oberoende av kön gäller att \[
\pi_{ij} = \pi_{i\circ}\pi_{\circ j}
\] där \(\pi_{ij}\) anger sannoliketen att en observation hamnar på rad
\(i\) och kolumn \(j\), \(\pi_{i\circ}\) anger sannolikheten att en
observation hamnar på rad \(i\) och \(\pi_{\circ j}\) anger
sannolikheten att en observation hamnar på kolumn \(j\). Sannolikheten
\(\pi_{ij}\) kan skattas med hjälp av observationera i kontingens
tabellen på följande vis
\[\widehat{\pi}_{ij} = \frac{n_{ij}}{n_{tot}}\], där \(\n_{tot}\) anger
det totala antalet observationer. Vi kan även skatta sannolikheten att
en observation hamnar i rad \(i\) med
\(\widehat{\pi}_{i\circ} = \frac{n_{i+}}{n_{tot}}\), där \(n_{i+}\)
anger summan av alla observationer på rad \(i\) och \(n_{+j}\)
motsvarande för kolumn \(j\). Det ger oss att under nollhypotesen
följande skattningar av de förväntade värdena
\(\widehat{e}_{ij} = n\widehat{\pi}_{i\circ}\widehat{\pi}_{\circ j}\).
Dessa uträkningar ger oss vår chitvå statiska med HUR MÅNGA
FRIHETSGRADER 8.2979214 som vi kan jämföra med en tabell.

``` r
library(tidyverse)
# install.packages("kableExtra")
cont_table = matrix(
  c(309, 191, 319, 281), # the data elements 
  nrow=2,              # number of rows 
  ncol=2,              # number of columns 
  byrow = TRUE)  # fill matrix by rows 
cont_table
```

    ##      [,1] [,2]
    ## [1,]  309  191
    ## [2,]  319  281

``` r
women_men = rowSums(cont_table)
favor_against = colSums(cont_table)
total = sum(cont_table)


# mapply(cont_table, f())
```

\[
\begin{aligned} 
G^{2} &= 2 \sum_{i} \sum_{j} \text{ observed } \times \ln \left( \frac{\text{observed}}{\text{expected}} \right)\\
&=2n \sum_{i} \sum_{j}  \widehat{p}_{ij} \ln \left( \frac{\widehat{p}_{ij}}{p_{ij}} \right)
\end{aligned}
\]

## 3\.

Vi vill ställa upp odds-kvoten

## 4\.

## 5\.

``` r
summary(cars)
```

    ##      speed           dist       
    ##  Min.   : 4.0   Min.   :  2.00  
    ##  1st Qu.:12.0   1st Qu.: 26.00  
    ##  Median :15.0   Median : 36.00  
    ##  Mean   :15.4   Mean   : 42.98  
    ##  3rd Qu.:19.0   3rd Qu.: 56.00  
    ##  Max.   :25.0   Max.   :120.00

## Including Plots

You can also embed plots, for example:

![](A1_files/figure-gfm/pressure-1.png)<!-- -->

Note that the `echo = FALSE` parameter was added to the code chunk to
prevent printing of the R code that generated the plot.
